<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:my="http://java.sun.com/jsf/composite/recursos"
      xmlns:p="http://primefaces.org/ui">
    
    <b:panelGrid columns="1">
        <b:row>
            <b:column span="12" class="text-center">
                <b:commandButton ajax="true"
                                 id="visible_examen"
                                 iconAwesome="#{CitaBean.visibleExamen ? 'fa-eye' : 'fa-eye-slash'}"
                                 action="#{CitaBean.switchExamen()}"
                                 value="#{CitaBean.visibleExamen ? '&nbsp; Mostrar Historial' : '&nbsp; Ocultar Historial'}"
                                 update="visible_examen :formExamenLabIma:panelContainerExamen :growl"
                                 tooltip="Mostrar Historial" look="primary">
                </b:commandButton>
            </b:column>
        </b:row>
        <br/>
        <p:outputPanel id="panelContainerExamen">
            <b:panel title="Exámenes de laboratorio e imagen" look="info" collapsible="false" id="listadoExamenPaciente" span="12" rendered="#{CitaBean.visibleExamen}">
                <b:dataTable large-screen="full-width" id="examenesTabla" value="#{CitaBean.lista_historia_examen}" var="historiaExamen" responsive="true" style="font-size: 11px; width: 100%" info="true" content-disabled="false" searching="true"
                   page-length="7" multi-column-search="true" multi-column-search-position="top" >
                    <b:dataTableColumn label="Tipo" value="#{CitaBean.antecedenteFormatoExamen(historiaExamen.examenes.exaTipo)}" style="width: 10%" />
                    <b:dataTableColumn label="Exámen" value="#{historiaExamen.examenes.exaGrupo}" style="width: 15%" />
                    <b:dataTableColumn label="Fecha Exámen" value="#{CitaBean.fechaFormatoYMDS(historiaExamen.hisExaFecha)}" style="width: 5%" />
                    <b:dataTableColumn label="Indicaciones" value="#{historiaExamen.hisExaIndicaciones}" style="width: 28%;" />
                    <b:dataTableColumn label="Resultado" value="#{historiaExamen.hisExaDescripcion}" style="width: 28%;" />
                    <b:dataTableColumn label="Acciones" style="width: 12%; padding-left: 1%; padding-right: 1%;"
                                       rendered="#{CitaBean.historia.hisCompletado eq '0'}"
                                       orderable="false"
                                       searchable="false">
                        <b:column span="1" offset="0">
                            <b:commandButton ajax="true"
                                             style="color: white !important;"
                                             update=":modalActualizarHistoriaExamen :growl"
                                             action="#{CitaBean.prepararActualizacionHistoriaExamen(historiaExamen)}"
                                             oncomplete="$('#modalActualizarHistoriaExamen').modal('show')" 
                                             tooltip="Editar resultado del exámen" 
                                             look="warning">
                                <b:iconAwesome name="pencil"></b:iconAwesome>
                            </b:commandButton>
                        </b:column>
                        <b:column offset="1" span="2">
                            <b:commandButton ajax="true"
                                             style="color: white !important;"
                                             tooltip="Eliminar exámen"
                                             onclick="return confirmarEliminacionExamen('#{historiaExamen.examenes.exaGrupo}','#{historiaExamen.hisExaDescripcion}');"
                                             look="danger">
                                <b:iconAwesome name="trash"></b:iconAwesome>
                                <f:ajax execute="@this"
                                        render="formExamenLabIma:panelContainerExamen:listadoExamenPaciente :growl"
                                        listener="#{CitaBean.eliminarHistoriaExamen(historiaExamen)}"/>
                            </b:commandButton>
                        </b:column>
                    </b:dataTableColumn>
                </b:dataTable>
            </b:panel>
            <b:panel title="Historial exámenes de laboratorio e imagen" look="info" collapsible="false" id="historialPanel" span="12" rendered="#{ not CitaBean.visibleExamen}">
                <b:dataTable large-screen="full-width" id="examenesHistoriaTabla" value="#{CitaBean.lista_Historial_historia_examen}" var="historiaExamen" responsive="true" style="font-size: 11px; width: 100%" info="true" content-disabled="false" searching="true"
                   page-length="7" multi-column-search="true" multi-column-search-position="top" >
                   <b:dataTableColumn label="Fecha" value="#{CitaBean.fechaFormatoYMDS(historiaExamen.hisExaFechaUlt)}" style="width: 5%" />
                   <b:dataTableColumn label="Tipo" value="#{CitaBean.antecedenteFormatoExamen(historiaExamen.examenes.exaTipo)}" style="width: 10%" />
                   <b:dataTableColumn label="Exámen" value="#{historiaExamen.examenes.exaGrupo}" style="width: 15%" />
                   <b:dataTableColumn label="Fecha Exámen" value="#{CitaBean.fechaFormatoYMDS(historiaExamen.hisExaFecha)}" style="width: 5%" />
                   <b:dataTableColumn label="Resultado" value="#{historiaExamen.hisExaDescripcion}" style="width: 35%" />
                   <b:dataTableColumn label="Doctor" orderable="false" searchable="false" value="#{historiaExamen.historias.personasByMedicoPerId.perApellidos} #{historiaExamen.historias.personasByMedicoPerId.perNombres}" style="width: 15%" />
                </b:dataTable>
            </b:panel>
        </p:outputPanel>
    </b:panelGrid>
</html>
