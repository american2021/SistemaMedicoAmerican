<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:my="http://java.sun.com/jsf/composite/recursos"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    
    <f:event listener="#{LoginBean.comprobarLogin}" type="preRenderView" />

    <h:head>
        <title>Departamento Médico</title>
        <link rel="shortcut icon" type="image/x-icon" href="#{request.contextPath}/img/favicon.ico" />
        <link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/main.css" />
    </h:head>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.71/pdfmake.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.71/vfs_fonts.js"></script>

    <script>
        $.blockUI.defaults.css = {
            padding: 0,
            margin: 0,
            width: '30%',
            top: '40%',
            left: '35%',
            textAlign: 'center',
            color: '#000',
            border: '0px solid #aaa',
            backgroundColor: 'transparent',
            cursor: 'wait'
        };
        $.blockUI.defaults.overlayCSS.backgroundColor = '#b4bab4'; //5E655E b4bab4 eac99a ff0000
        $.blockUI.defaults.overlayCSS.opacity = 0.5;
        $.blockUI.defaults.message = '<b:spinner name="refresh" size="4x" style-class="spiner"/>';
    </script>
    
    <script>
        
        function confirmarEliminacionTratamiento(descripcion, nombre, indicaciones) {
            var mensaje = '¿Está seguro de que desea eliminar el tratamiento ' + descripcion + ', con el medicamento ' + nombre + ', además las indicaciones ' + indicaciones + ' ?';
            return confirm(mensaje);
        }
        
        function confirmarEliminacionAntecedente(nombre, descripcion) {
            var mensaje = '¿Está seguro de que desea eliminar el antecedente ' + nombre + ', con la descripción ' + descripcion + ' ?';
            return confirm(mensaje);
        }
        
        function confirmarEliminacionDiagnostico(descripcion, observacion) {
            var mensaje = '¿Está seguro de que desea eliminar el diagnóstico ' + descripcion +  ', con la observación ' + observacion +' ?';
            return confirm(mensaje);
        }
        
        function confirmarEliminacionExamen(exaGrupo, resultado) {
            var mensaje = '¿Está seguro de que desea eliminar el examen ' + exaGrupo +  ', con resultado ' + resultado +' ?';
            return confirm(mensaje);
        }
    </script>

    <b:scrollUp distance="200" animation="fade" text="" name="scrollUpCustom" />
    
    <my:cabecera id="cabecera"/>
    <my:menuHorizontalMedico id="menuHorizontalMedico"/>
   <!--  <my:menuLateralEstudiante id="menuLateralEstudiante"/>-->
    <!--<my:menuLateralAdministrador id="menuLateralAdministrador"/>-->
    <my:menuHorizontalAdministrador id="menuHorizontalAdministrador"/>
    <!--<my:menuLateralContador id="menuLateralContador"/>-->
 
    <h:body onload="toggleHistorialPanel()">
        <b:modal id="modalActualizarHistoriaExamen" title="Actualizar examen" closable="true"
                 close-on-escape="true" backdrop="true" size="modal-lg">
            <ui:include src="citaMedica/modalActualizarExamen.xhtml" />
        </b:modal>
        <b:modal id="modaUpdateHistoriaDiagnostico" title="Actualizar diagnóstico" closable="true"
         close-on-escape="true" backdrop="true" size="modal-lg">
            <ui:include src="citaMedica/modalActualizarDiagnostico.xhtml" />
        </b:modal>
        <b:modal id="modaUpdateHistoriaTratamiento" title="Actualizar tratamiento" closable="true"
                 close-on-escape="true" backdrop="true" size="modal-lg">
            <ui:include src="citaMedica/modalActualizarTratamiento.xhtml" />
        </b:modal>
        <b:modal id="modalAddDiagnostico" title="Crear diagnóstico" closable="true"
                 close-on-escape="true" backdrop="true" size="modal-lg">
            <ui:include src="citaMedica/modalCrearDiagnostico.xhtml" />
        </b:modal>
        <b:modal id="modalUpdateAntecedente" title="Actualizar antecedente" closable="true"
                 close-on-escape="true" backdrop="true" size="modal-lg">
            <ui:include src="citaMedica/modalActualizarAntecedente.xhtml" />
        </b:modal>
        
        <b:modal id="modalDeleteHistoriaTratamiento" title="Eliminar Tratamiento" closable="true"
                 close-on-escape="true" backdrop="true" size="modal-lg">
            <ui:include src="citaMedica/modalEliminarTratamiento.xhtml" />
        </b:modal>
        
        <style>
            #modalDeleteHistoriaTratamiento .modal-header {
                text-align: center;
            }
            #modalDeleteHistoriaTratamiento .modal-title {
                margin: 0 auto;
            }
            .custom-button{
                margin-top: 6px;
                color: #333333;
                -webkit-transition: all 0.2s ease-in-out;
                -o-transition: all 0.2s ease-in-out;
                transition: all 0.2s ease-in-out;
                background: #ffffff;
                line-height: 1.428571429;
                border: 1px solid transparent;
                  border-top-color: transparent;
                  border-right-color: transparent;
                  border-bottom-color: transparent;
                  border-left-color: transparent;
                border-radius: 4px 4px 0 0;
                width: 100%;
                border-color: #e7e7e7;
                
                position: relative;
                display: block;
                padding: 10px 15px;
                
            }
            .custom-button:hover{
                padding-bottom: 15px;
                margin-top: 0;
                background: #ffffff;
            }
            .ui-widget input, .ui-widget select, .ui-widget textarea, .ui-widget button{
                font-family: "Source Sans Pro", "Helvetica Neue", Helvetica, Arial, sans-serif !important;
                font-size: 14px !important;
                line-height: 1.428571429 !important;
            }
        </style>
        
        <p:idleMonitor timeout="600000">
            <p:ajax event="idle" listener="#{LoginBean.sesionInactiva()}" />
        </p:idleMonitor>
       
        <b:growl id="growl" escape="true" />
        
        <b:container fluid="true">
           
            <div class="vertical-tabview">
                <b:row>
                    <b:form>
                        <b:column span="2">
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Historia Clínica" 
                                                     styleClass="btn btn-default custom-button"
                                                     action="#{CitaBean.cambioPanel('panel1', true)}"
                                                     update="formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion"/>
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Antecedente"
                                                     styleClass="btn btn-default custom-button"
                                                     action="#{CitaBean.cambioPanel('panel2', true)}"
                                                     update="formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion"/>
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true" 
                                                     value="Signos" 
                                                     styleClass="btn btn-default custom-button" 
                                                     action="#{CitaBean.cambioPanel('panel3', true)}"
                                                     update="formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion"/>
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Revisión de órganos y sistemas" 
                                                     styleClass="btn btn-default custom-button" 
                                                     action="#{CitaBean.cambioPanel('panel4', true)}"
                                                     update="formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion"/>
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Examen fisico" 
                                                     styleClass="btn btn-default custom-button" 
                                                     action="#{CitaBean.cambioPanel('panel5', true)}"
                                                     update="formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion" />
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Exámenes" 
                                                     styleClass="btn btn-default custom-button" 
                                                     action="#{CitaBean.cambioPanel('panel6', true)}"
                                                     update="formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion" />
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Diagnóstico" 
                                                     styleClass="btn btn-default custom-button" 
                                                     action="#{CitaBean.cambioPanel('panel7', true)}"
                                                     update="formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion" />
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Tratamiento" 
                                                     styleClass="btn btn-default custom-button" 
                                                     action="#{CitaBean.cambioPanel('panel8', true)}"
                                                     update="#{CitaBean.updatePanel == true ? 'formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion :growl' : ' :growl'}" />
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Indicaciones" 
                                                     styleClass="btn btn-default custom-button" 
                                                     action="#{CitaBean.cambioPanel('panel9', true)}"
                                                     update="#{CitaBean.updatePanel == true ? 'formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion :growl' : ' :growl'}" />
                                </b:column>
                            </b:row>
                            <b:row>
                                <b:column  style="text-align: center;">
                                    <b:commandButton ajax="true"
                                                     value="Evolución" 
                                                     styleClass="btn btn-default custom-button" 
                                                     action="#{CitaBean.cambioPanel('panel10', true)}"
                                                     update="formHistoriaClinica formAntecedente formSignos formRevision formExamenFisico formExamenLabIma formDiagnostico formPrescripcion  formIndicaciones formEvolucion :growl" />
                                </b:column>
                            </b:row>
                        </b:column>
                    </b:form>
                    
                    <b:column span="10" id="allPanel">
                        <b:form id="formHistoriaClinica">
                            <p:outputPanel id="panelOut1" rendered="#{CitaBean.menuPanel['panel1']}">
                                <b:panelGrid columns="1" id="panelGrid2" span="12">
                                    <ui:include src="citaMedica/tabContentHistoriaClinica.xhtml"/>
                                    <ui:include src="citaMedica/panelListadoHistoriaClinica.xhtml"/>
                                    <ui:include src="citaMedica/footer.xhtml">
                                        <ui:param name="panelBefore" value="panel0" />
                                        <ui:param name="panelNext" value="panel2" />
                                        <ui:param name="tooltipBefore" value="" />
                                        <ui:param name="tooltipNext" value="Antecedente" />
                                    </ui:include>
                                </b:panelGrid>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formAntecedente">
                            <p:outputPanel id="panelOut2" rendered="#{CitaBean.menuPanel['panel2']}">
                                <h3 id="reply-title">
                                    <b>Antecedentes</b>
                                </h3>
                                <b:panel title="Listado de antecedentes" look="info" collapsible="false" id="listadoAntecedente" rendered="#{CitaBean.historia.hisCompletado eq '0'}">
                                    <b:tabView style-class="width: 100%">
                                        <b:tab title="Personal">
                                            <ui:include src="citaMedica/tabContentAntecedente.xhtml">
                                                <ui:param name="mapaElementos" value="#{CitaBean.mapAntecedentePer}" />
                                            </ui:include>
                                        </b:tab>
                                       <b:tab title="Familiar">
                                            <ui:include src="citaMedica/tabContentAntecedente.xhtml">
                                                <ui:param name="mapaElementos" value="#{CitaBean.mapAntecedenteFam}" />
                                            </ui:include>
                                        </b:tab>
                                         <b:tab title="Gineco/Obstétrico">
                                            <ui:include src="citaMedica/tabContentAntecedente.xhtml">
                                                <ui:param name="mapaElementos" value="#{CitaBean.mapAntecedenteGin}" />
                                            </ui:include>
                                        </b:tab>
                                        <b:tab title="Vacunación">
                                            <ui:include src="citaMedica/tabContentAntecedente.xhtml">
                                                <ui:param name="mapaElementos" value="#{CitaBean.mapAntecedenteVac}" />
                                            </ui:include>
                                        </b:tab>
                                    </b:tabView>
                                </b:panel>
                                <ui:include src="citaMedica/panelListadoAntecedentes.xhtml"/>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel1" />
                                    <ui:param name="panelNext" value="panel3" />
                                    <ui:param name="tooltipBefore" value="Historia Clínica" />
                                    <ui:param name="tooltipNext" value="Signos" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formSignos">
                            <p:outputPanel id="panelOut3" rendered="#{CitaBean.menuPanel['panel3']}">
                                <ui:include src="citaMedica/panelSignoPaciente.xhtml"/>
                                <ui:include src="citaMedica/panelListadoSignoPaciente.xhtml"/>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel2" />
                                    <ui:param name="panelNext" value="panel4" />
                                    <ui:param name="tooltipBefore" value="Antecedentes" />
                                    <ui:param name="tooltipNext" value="Revisión de órganos y sistema" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formRevision">
                            <p:outputPanel id="panelOut4" rendered="#{CitaBean.menuPanel['panel4']}">
                                <b:panelGrid columns="1" id="panel4" span="12">
                                    <ui:include src="citaMedica/panelRevision.xhtml"/>
                                    <ui:include src="citaMedica/panelListadoRevisionSistema.xhtml"/>
                                </b:panelGrid>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel3" />
                                    <ui:param name="panelNext" value="panel5" />
                                    <ui:param name="tooltipBefore" value="Signo" />
                                    <ui:param name="tooltipNext" value="Examen fisico" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formExamenFisico">
                            <p:outputPanel id="panelOut5" rendered="#{CitaBean.menuPanel['panel5']}">
                                <ui:include src="citaMedica/tabContentExamenFisico.xhtml"/>
                                <ui:include src="citaMedica/panelListadoExamenFisico.xhtml"/>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel4" />
                                    <ui:param name="panelNext" value="panel6" />
                                    <ui:param name="tooltipBefore" value="Revisión de órganos y sistema" />
                                    <ui:param name="tooltipNext" value="Exámenes" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formExamenLabIma">
                            <p:outputPanel id="panelOut6" rendered="#{CitaBean.menuPanel['panel6']}">
                                <b:panelGrid columns="1" id="panel6" span="12" offset="0">
                                    <h3 id="reply-title">
                                        <b>Exámenes</b>
                                    </h3>
                                    <b:panel title="Listado de exámenes" 
                                             look="info" 
                                             collapsible="false" 
                                             rendered="#{CitaBean.historia.hisCompletado eq '0'}"
                                             id="listadoExamenes">
                                        <b:tabView style-class="width: 100%">
                                            <b:tab title="Laboratorio">
                                                <ui:include src="citaMedica/tabContentExamen.xhtml">
                                                    <ui:param name="lista" value="#{CitaBean.listaExamenesLab}" />
                                                </ui:include>
                                            </b:tab>
                                            <b:tab title="Imagenología">
                                                <ui:include src="citaMedica/tabContentExamen.xhtml">
                                                    <ui:param name="lista" value="#{CitaBean.listaExamenesImg}" />
                                                </ui:include>
                                            </b:tab>
                                            <b:tab title="Histopatología">
                                                <ui:include src="citaMedica/tabContentExamen.xhtml">
                                                    <ui:param name="lista" value="#{CitaBean.listaExamenesHist}" />
                                                </ui:include>
                                            </b:tab>
                                        </b:tabView>
                                    </b:panel>
                                    <ui:include src="citaMedica/panelListadoExamen.xhtml"/>
                                </b:panelGrid>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel5" />
                                    <ui:param name="panelNext" value="panel7" />
                                    <ui:param name="tooltipBefore" value="Examen fisico" />
                                    <ui:param name="tooltipNext" value="Diagnóstico" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formDiagnostico">
                            <p:outputPanel id="panelOut7" rendered="#{CitaBean.menuPanel['panel7']}">
                                <b:panelGrid columns="1" span="12" offset="0">
                                    <h3 id="reply-title">
                                        <b>Diagnóstico</b>
                                    </h3>
                                    <b:panel title="Listado de diagnóstico" 
                                             look="info" 
                                             collapsible="false"
                                             rendered="#{CitaBean.historia.hisCompletado eq '0'}"
                                             id="listadoDiagnostico">
                                        <b:row>
                                            <b:column span="12" class="text-center">
                                                <b:commandButton ajax="true"
                                                                 value="&nbsp; Nuevo diagnóstico"
                                                                 oncomplete="$('#modalAddDiagnostico').modal('show')"
                                                                 tooltip="Crear exámenes" look="primary">
                                                    <b:iconAwesome name="plus"></b:iconAwesome>
                                                </b:commandButton>
                                            </b:column>
                                        </b:row>
                                        <ui:include src="citaMedica/tabContentDiagnostico.xhtml">
                                            <ui:param name="lista" value="#{CitaBean.lista_diagnosticos_all}" />
                                        </ui:include>
                                    </b:panel>
                                    <ui:include src="citaMedica/panelListadoDiagnostico.xhtml"/>
                                </b:panelGrid>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel6" />
                                    <ui:param name="panelNext" value="panel8" />
                                    <ui:param name="tooltipBefore" value="Exámenes" />
                                    <ui:param name="tooltipNext" value="Tratamiento" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formPrescripcion">
                            <p:outputPanel id="panelOut8" rendered="#{CitaBean.menuPanel['panel8']}">
                                <b:panelGrid columns="1" span="12" offset="0">
                                    <b:panel span="12" offset="0" id="panelTratamiento">  
                                        <ui:include src="citaMedica/panelPrescripcion.xhtml"/>
                                    </b:panel>
                                    <ui:include src="citaMedica/panelListadoTratamiento.xhtml"/>
                                </b:panelGrid>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel7" />
                                    <ui:param name="panelNext" value="panel9" />
                                    <ui:param name="tooltipBefore" value="Diagnóstico" />
                                    <ui:param name="tooltipNext" value="Indicaciones" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formIndicaciones">
                            <p:outputPanel id="panelOut9" rendered="#{CitaBean.menuPanel['panel9']}">
                                <ui:include src="citaMedica/tabContentIndicaciones.xhtml"/>
                                <ui:include src="citaMedica/panelListadoIndicaciones.xhtml"/>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel8" />
                                    <ui:param name="panelNext" value="panel10" />
                                    <ui:param name="tooltipBefore" value="Tratamiento" />
                                    <ui:param name="tooltipNext" value="Evolución" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                        <b:form id="formEvolucion">
                            <p:outputPanel id="panelOut10" rendered="#{CitaBean.menuPanel['panel10']}">
                                <b:panelGrid columns="1" id="panel5">
                                    <h3>
                                        <b>Evolución</b>
                                    </h3>
                                    <b:panel title="Evolución del paciente" look="info" collapsible="false">
                                        <b:row>
                                            <b:column span="12">
                                                <b:inputTextarea label="Evolución"
                                                             placeholder="Ingrese evolución"
                                                             id="indicaciones"
                                                             size="13"
                                                             rows="5"
                                                             maxlength="2000"
                                                             value="#{CitaBean.historia.hisEvolucion}"/>
                                            </b:column>
                                        </b:row>
                                    </b:panel>
                                </b:panelGrid>
                                <ui:include src="citaMedica/footer.xhtml">
                                    <ui:param name="panelBefore" value="panel9" />
                                    <ui:param name="panelNext" value="panel11" />
                                    <ui:param name="tooltipBefore" value="Indicaciones" />
                                    <ui:param name="tooltipNext" value="Guardar" />
                                </ui:include>
                            </p:outputPanel>
                        </b:form>
                    </b:column>
                </b:row>
            </div>
        </b:container>
        <br/><br/>
    </h:body>
    <my:piePagina id="piePagina"/>
</html>